\documentclass{ximera}
\title{The Chain Rule}

\newcommand{\pskip}{\vskip 0.1 in}

\begin{document}
\begin{abstract}
An introduction to the chain rule.
\end{abstract}
\maketitle


The chain rule tells us how to differentiate the composition of two functions. It say that the derivative of the composition is the product of the derivatives of the two functions.

Here is a more formal statement.

\begin{theorem}
(The Chain Rule) If $y=f(u)$ is a differentiable function of $u$ and $u=g(t)$ is a differentiable function of $t$, then the composition
\[
      y = f(g(t))
\]
is a differentiable function of $t$ and
\[
   \frac{dy}{dt} = \frac{dy}{du} \cdot \frac{du}{dt} .
\]
Or paying closer attention to the inputs,
\[
      \frac{dy}{dt}\Big|_{t=t_0} = \frac{dy}{du}\Big|_{u=g(t_0)} \cdot \frac{du}{dt}\Big|_{t=t_0} . 
\]

\end{theorem}


We'll go through some examples to get an understanding of how to use the chain rule and also why it works.


\section*{Examples}

\begin{example}  \label{Ex:GDFGDFGff}
Find an equation of the tangent line to the curve
\[
  y = f(x) = \left( 2x^3 +1  \right)^2
\]
at the point $(1,9)$.

\begin{explanation}
Let 
\[
       y = \left( 2x^3 +1  \right)^2
\]
and 
\[
      u = 2x^3 + 1 .
\]
Then
\[
     y = u^2
\]
and
\begin{align*}
\frac{dy}{dx} &= \frac{dy}{du} \cdot \frac{du}{dx}  \\
                     &= \frac{d}{du} \left( u^2 \right)  \cdot \frac{d}{dx}\left(  2x^3 + 1 \right)  \\
                     &= 2u (6x^2)  \\
                     &= 2(2x^3+1)(6x^2) .
\end{align*}

Then the slope of the tangent line to the curve $y=(2x^3+1)^2$ at the point $(1,9)$ is 
\[
              \frac{dy}{dx}\Big|_{x=1} = 2(3)(6) = 36 ,
\]
and an equation of the tangent line is
\[
   y - 9 = 36(x-1) .
\]

\pskip 

We can get the same result without the chain rule, by rewriting the original function as
\[
     y = f(x) = (2x^3+1)^2 = 4x^6 + 4x^3 + 1.
\] 
Then
\begin{align*}
      \frac{dy}{dx} &= \frac{d}{dx} \left(  4x^6 + 4x^3 + 1  \right) \\
                         &= 4\frac{d}{dx}\left( x^6 \right) + 4 \frac{d}{dx}\left( x^3 \right) + \frac{d}{dx}\left(1 \right) \\
                        &=   24x^5 + 12x^2 .
\end{align*}

Then the slope of the tangent line to the curve $y=(2x^3+1)^2$ at the point $(1,9)$ is 
\[
              \frac{dy}{dx}\Big|_{x=1} =14 + 12 = 36 ,
\]
as before.

\end{explanation}
\end{example}


\begin{example}  \label{Ex:DFdg4ergg}
Find an equation of the tangent line to the curve
\[
     x^2 + y^2 = 25
\]
at the point $P(4,-3)$.

\begin{explanation}
Solve the above equation for $y$ in terms of $x$ to get
\[
      y = \pm \sqrt{25-x^2} .
\] 
While this equation does not define $y$ as a function of $x$, near the point $(4,-3)$, the equation
\[
         y = - \sqrt{25-x^2} 
\]
does define $y$ as a function of $x$.

Now to find the derivative of the function
\[
          y = - \sqrt{25-x^2} ,
\]
let 
\[
       u = 25 - x^2 .
\]
Then
\[
    y = \sqrt{u} = - u^{1/2}
\]
and 
\begin{align*}
\frac{dy}{dx} &= \frac{dy}{du} \cdot \frac{du}{dx}  \\
                     &= \frac{d}{du} \left(- u^{1/2} \right)  \cdot \frac{d}{dx}\left(  25-x^2 \right)  \\
                     &= -\frac{1}{2\sqrt{u}} (-2x)  \\
                     &= \frac{x}{\sqrt{25-x^2}}.
\end{align*}

So the slope of the tangent line to the curve
\[
       x^2 + y^2 =25
\]
at the point $(P(4,-3)$ is
\[
             \frac{dy}{dx}\Big|_{x=4} = \left(  \frac{x}{\sqrt{25-x^2}} \right) \Big|_{x=4} = \frac{4}{3}
\]
and an equation of the tangent line is
\[
     y +3 = \frac{4}{3} (x-4).
\]

To find the slope of the tangent line without appealing to the chain rule, note that the curve
\[
              x^2 + y^2  = 25
\]
is a circle centered at the origin. So the tangent line at $P(4,-3)$ is perpendicular to the radius $\overline{OP}$ from the origin to $P$. Since $\overline{OP}$ has slope $m_1 = -3/4$, the tangent line at $P(4,-3)$ has slope
\[
     m_2 = - 1 / m_1  = 4/3 .
\]
\end{explanation}
\end{example}


\begin{question}  \label{Ex:LKKkdftr}
(a) Describe a transformation that takes the circle
\[
     x^2 + y^2 = 25
\]
to the ellipse
\begin{equation}
     4x^2 + y^2 = 25.     \label{Eq:Ellipse}
\end{equation}

(b) Find the image (call it $Q$) of the point $P(4,-3)$ under the transformation in part (a).

(c) Use the result of Example 2 to find an equation of the tangent line to the ellipse (\ref{Eq:Ellipse}) at $Q$.

(d) Use the chain rule to first find the slope of the tangent line to the ellipse (\ref{Eq:Ellipse}) at $Q$. Then find an equation of the tangent line.

\end{question}


\begin{question}  \label{Ex:pdfsd0tr}
The function 
\[
       P  = f(t) = 22 + \frac{t}{2} - \frac{3t^2}{4} , 0\leq t \leq 3 , 
\]
expresses the price of a stock (in dollars/share) in terms of the number of hours past 9am.

(a) Is the price of the stock increasing or decreasing at 11am? At what rate? At what relative rate?

(b) Is the number of shares you can buy with $\$1000$ increasing or decreasing at 11am? Approximate the rate numerically.

(c) Compute the exact rate in part (b). Compute also the relative rate of change (with respect to time) in the number of shares you can buy with $\$1000$ at 11am.

Start your solution to this problem by defining a new function with a new function name and a new depedent variable.

\end{question}


\begin{question} \label{Ex:sd0fset}
At 10am the price of a stock is increasing at the relative rate of $p\%$/hr. Is the number of shares you can buy with $\$1000$ increasing or decreasing at 10am? At what relative rate?

Answer this question in two ways:

(i) Going back to limits and using the definition of the derivative.

(ii) Using the chain rule.

Either way, start your solution with defintions as in the previous problem.

\end{question}


\begin{question}  \label{Q:df0g43rb4}
A tree leans precariously with its trunk making an angle of $\phi = \pi/3$ radians with the ground. One end of a $14$-foot ladder leans against the trunk, the other rests on the horizontal ground.

Let $t$ be the distance between the top of the ladder and the base of the trunk (measured in feet) and $s$ the distance between the bottom of the ladder and the base of the trunk (also measured in feet).

\begin{onlineOnly}
    \begin{center}
\geogebra{ctf2bcqz}{900}{600}
\end{center}
\end{onlineOnly}

Geogebra activity available at \href{https://www.geogebra.org/classic/ctf2bcqz}{151: Ladder and Tree Part 2}


(a) Use the law of cosines to write an equation relating $t$ and $s$.

(b) Use the result of part (a) to find the two possible values of $t$ when $s=16$. 

\pskip

For the remainder of this problem we'll focus on positions of the ladder when $s \sim 16$ and $t\sim 10$. 

(c) For these positions, complete the square to find a function 
\[
    t = f(s)
\]
that expresses the distance (in feet) from the top of the ladder to the base of the trunk in terms of the distance (in feet) from the bottom of the ladder to the trunk's base.

(d) Drag the slider $\theta$ in the worksheet above to approximate the value of the derivative
\[
     \frac{dt}{ds}\Big|_{s=16} .
\]
Include units and explain your reasoning. %Explain the meaning of this derivative \emph{in terms of small changes}.

(e) Use your function from part (c) to find an expression for the derivative $dt/ds$. Show \emph{every step} in computing the derivative as in Examples 1 and 2 above.

(f) Evaluate the derivative 
\[
       \frac{dt}{ds}\Big|_{s=16} 
\]
and compare the exact value with your estimate from part (d). 

(g) What are the units of the derivative in part (f)? Explain the meaning of the derivative, \emph{not} by giving a standard response about the rate of change of some quantity with respect to another, but by relating small changes.

(h) Use your response to part (f) to write an approximation for the change
\[
         \Delta t = f(s) - f(16)
\]
in terms of the change 
\[
     \Delta s = s - 16
\]
for values of $s$ near $s=16$. Use this approximation to estimate the distance between the top of the ladder and the base of the trunk when the bottom of the ladder is 15.6 feet from the base of the trunk. Compare your approximation with the exact distance.

(h) Let $\theta = m\angle GBA$ be the radian measure of the angle the ladder makes with the trunk. 

(i) Find an expression for the derivative $d\theta/ds$ .

(ii) Evaluate the derivative 
\[
     \frac{d\theta}{ds}\Big|_{s=16}
\]
and interpret its meaning in terms of small changes. Be sure to explain the significance of the derivative's sign as well.

\end{question}


\begin{example}  \label{Ex:CHr34rrer}
(a) Find the slope of the tangent line to the curve
\[
   y = f(\theta) = 6 \sin \theta
\]
at the point with coordinates $P(2\pi/3, 3\sqrt{3})$. We do not need the chain rule for this.

(b) Describe a transformation that takes the graph of $y=f(\theta)$ to the graph of the function
\[
        y = g(\theta) = 6\sin (\theta/2) .
\]

(c) Find the image of the point $P(2\pi/3,3\sqrt{3})$ under the above transformation.

(d) Use the results of parts (a) - (c) and the demonstration below to guess the slope of the tangent line to the curve $y=g(\theta)$ at the point $Q(4\pi,3\sqrt{3})$.

\begin{onlineOnly}
    \begin{center}
\desmos{mqjxpsqyo5}{900}{600}
\end{center}
\end{onlineOnly}

Desmos activity available at \href{https://www.desmos.com/calculator/mqjxpsqyo5}{151: Chain Rule 1}

\pskip

(e) Use the chain rule to confirm your guess from part (d).

\end{example}



\begin{example}  \label{Ex:df4thghg}
Find an equation of the tangent line to the curve
\[
  y = f(t) = 4 \sin^2 \left( \frac{\pi}{6}t \right)
\]
at the point $(2,3)$.

\begin{explanation}
Let 
\[
       y = 4 \sin^2 \left( \frac{\pi}{6}t \right) =  4 \left( \sin \left( \frac{\pi}{6}t \right)\right)^2
\]
and 
\[
      u = \sin\left( \frac{\pi}{6}t \right) .
\]
Then
\[
     y =4 u^2
\]
and
\begin{align*}
\frac{dy}{dt} &= \frac{dy}{du} \cdot \frac{du}{dt}  \\
                     &= \frac{d}{du} \left( 4u^2 \right)  \cdot \frac{d}{dt}\left(  \sin\left( \frac{\pi}{6}t \right)  \right)  \\
                     &= 8u   \cos \left(   \frac{\pi}{6}t  \right) \frac{d}{dt} \left( \frac{\pi}{6}t  \right)     \\
                     &= 8\sin\left( \frac{\pi}{6}t \right)  \cos \left(   \frac{\pi}{6}t  \right) \frac{\pi}{6} .
\end{align*}

\begin{question}  \label{Q:dsf4tt}
(a) The third equality above uses the chain rule again. Fill in the missing details of this computation by first letting
\[
    z = \sin \left(  \frac{\pi}{6}y \right)
\]
and making an explicit substitution using the variable $v$ in place of $u$.

(b) Complete the solution by finding an equation of the tangent line to the curve at the point $(2,3)$. 
\end{question}
\end{explanation}
\end{example}


\begin{question} \label{Q:ds99fgg0sdf}
Use the chain rule to compute each of the following derivatives. Show \emph{all} steps as in Examples 1, 2, and 8 above.

(a) $\frac{d}{dx} \left(  \frac{12}{1+x^2} \right)$

(b) $\frac{d}{dt} \left( 12 (3)^{t/5}   \right)$

(b) $\frac{d}{dt} \left(  e^{3 \sin (4t)} \right)$

(b) $\frac{d}{d\theta} \left( 12 + 5 \cos (\theta/4)   \right)$

\end{question}


\begin{example}  \label{Ex:Chdfr5llk}
The function 
\[
       P = f(t) = 10 e^{\frac{1}{4}t} \, , \, -4\leq t \leq 12 ,
\] 
expresses the population (in millions) of a colony of bacteria in terms of the number of hours past noon.

(a) What are the units of $1/4$ in the function above? How do you know?

(b)  Use the chain rule to find an expression for the growth rate of the population at time $t$ hours past noon. What are the units of the growth rate?

(c) Express the growth rate from part (b) in terms of the population $P=f(t)$ at time $t$ hours past noon.

(d) What is the relative instantaneous growth rate of the population? Include units.

(e) Find the relative average growth rate of the population over a one-hour period. 

(f) Describe what happens to the population every hour.

\end{example}

\begin{example}  \label{Ex:CHHODDrer}
 (a) Use the chain rule to find the relative instantaneous growth rate of the population function
\[
      P = 10 (2^t)  \, , \, -2\leq t \leq 5 ,
\]
where $P$ is measured in millions of bacteria and $t$ is the number of hours past noon.

(b) Describe what happens to the population every hour.

(c) Estimate the population 2 minutes after there are 30 million bacteria.
\end{example}




\begin{question}  \label{Ex:CHdfthghhyhpp}
This problem suggests a way to think about the chain rule geometrically.

You ride a ferris wheel for one revolution and get off. The function 
\[
    h = f(\theta) = \, , \, 0\leq \theta \leq 2\pi ,   %40 - 30\cos \theta \, , \, 0\leq \theta \leq 2\pi ,
\]
expresses your height (in feet) in terms of the wheel's angle of rotation (measured in radians from the moment you boarded).

The function 
\[
    \theta = g(t) \, , \, 0\leq t \leq 44, 
\]
expresses the rotation angle of the wheel in terms of the number of seconds since  you boarded.

Our goal is to use the graphs of the function $f$ and $g$ below (take the times $t$ to be postive, not negative as shown) to approximate your rate of ascent $t=16$ seconds after boarding. We'll do this in two different ways.

(a) The first way involves a few steps and uses the graphs of both $f$ and $g$. 

(i) Approximate the value of the derivative
\[
   \frac{dh}{d\theta}\Big|_{\theta = g(16)} 
\]
and interpet its meaning. Include units.

(ii) Approximate the value of the derivative 
\[
    \frac{d\theta}{dt}\Big|_{t=16} 
\]
and interpet its meaning. Include units.

(iii) Use the results of (i) and (ii) and common sense (do not appeal to the chain rule directly) to approximate the value of the derivative
\[
   \frac{dh}{dt}\Big|_{t=16}  =  h^\prime(16),
\]
where $h(t) = f(g(t))$. Explain your logic and include all units in your computation. Interpret the meaning of this derivative.

(b) The second way has just one step and that's to use the graph of $h=f(\theta)$ to approximate your rate of ascent at time $t=16$ using the fact that the horizontal blue lines are drawn at intervals of $\Delta t = 2$ seconds. Be sure to explain your logic.


\begin{onlineOnly}
    \begin{center}
\desmos{fkgfpsowe8}{900}{600}
\end{center}
\end{onlineOnly}

Desmos activity available at \href{https://www.desmos.com/calculator/fkgfpsowe8}{151: Ferris Wheel 2}

\end{question}

\begin{question} \label{Q:3rerfggg}
This is a continuation of the previous question.

Approximate the time between times $t=5$ and $t=22$ seconds when you are ascending at the slowest rate. Approximate this rate of ascent. 

\end{question}

\begin{question}  \label{Q:Lkdefdsf99}
The center of a ferris wheel with a radius of 50 feet is 60 feet above the ground. You ride the wheel for one revolution and get off.

(a) Use the geometry of the ferris wheel (see the picture below) to find a function 
\[
 h = f(\theta) \, , \, 0\leq \theta \leq 2\pi ,
\] 
that expresses your height (in feet) above the ground in terms of the rotation angle of the wheel, measured in radians. Use the \emph{cosine} function, \emph{not} the sine function.

\begin{onlineOnly}
    \begin{center}
\geogebra{tn75cq93}{900}{600}
\end{center}
\end{onlineOnly}

%https://www.geogebra.org/classic/tn75cq93

(b) Suppose you move at the constant speed of $10$ ft/sec as you ride the ferris wheel.

(i) Use the result of part (a) to find a function $h=g(t)$ that expresses your height (in feet) in terms of the number of seconds since you boarded. Include the appropriate domain.

(ii) Find a function $r=h(t)$ that expresses your rate of ascent (in ft/sec) in terms of the number of seconds since you boarded. Include the appropriate domain. Use vectors to interpret this rate geometrically, in terms of the angle your velocity makes with the horizontal and your speed.

(iii) Write an equation that relates your height $h$ (in feet) and your rate of ascent $r$ (in ft/sec) at any instant. Graph the relation by hand.

(iv) Are you going up or down the second time you are $100$ feet above the ground? At what rate?

(v) What is your height when you are descending at the rate of $4$ ft/sec? Find all possibilities.

\end{question}

\begin{question}  \label{Q:34e5t4566}
The function
\[
    \theta = f(t) , t \geq 0 ,
\]
expresses the radian measure of a ferris wheel's rotation angle in terms of the number of seconds since you boarded. The wheel has radius $r$ feet and its center is $b$ feet above the ground. 

(a) Find a function
\[
     h = g(t) , t \geq 0,
\]
 that expresses your height (in feet) in terms of the number of seconds since you boarded. 

(b) Find an expression for your rate of ascent (in ft/sec) at time $t$ seconds after you boarded. Assume $g$ is a differentiable function of $t$.

(c) Interpret your rate of ascent (part (b)) in terms of your speed at time $t$ and the angle your velocity vector makes with the horizontal. Assume here that $\theta=f(t)$ is an increasing function of $t$. 
\end{question}



\section*{Exercises}

\begin{exercise}  \label{ExLdfsdfll}
Use the facts that 
\[
\frac{d}{d\theta} \left( \sin\theta \right) = \cos\theta
\]
and
\[
\frac{d}{d\theta} \left( \cos\theta \right) = -\sin\theta
\]
to compute each of the following derivatives. Show all steps in using the chain rule as in Examples 1 and 2 above.

(a) $\frac{d}{d\theta} \left( \sec\theta \right)$

(b) $\frac{d}{d\theta} \left( \csc\theta \right)$

(c) $\frac{d}{dt} \left( \sqrt{\sin^2 t + (4-\cos t )^2} \right)$  

\begin{hint}
Simplify the function first.
\end{hint}

(d)  $\frac{d}{d\theta} \left( \sec^2\theta \right)$

(e) $\frac{d}{dt} \left( \frac{1}{5+3\cos (t/2)}   \right)$

\end{exercise}


\begin{exercise}  \label{Ex:dsfthnmmm}
You jog around a circular track of radius $r$ feet at the constant speed of speed of $v$ ft/sec. A flagpole lies $b$ feet due east of the track's center.

(a) Use the animation below (and nothing else) to sketch by hand a graph of the function 
\[
   s = f(\theta) \, , \theta \geq 0,
\]
that expresses your distance (in feet) to the flagpole in terms of your angle $\theta = \angle FOJ$ of rotation about the track's center, measured in radians from the time you start. Assume you start at the point $A$ on the track nearest the flagpole. Be sure to include variable names, units, and scales on your axes. Explain your reasoning. For this particular graph assume that $r=40$ and $b=96$ (be sure to adjust the sliders in the worksheet to have these values).

\begin{onlineOnly}
    \begin{center}
\desmos{4pndurvhdd}{900}{600}
\end{center}
\end{onlineOnly}

Worksheet available at \href{https://www.desmos.com/calculator/4pndurvhdd}{151: Jogger}

(b) Using only your graph of the function $f$ from part (a), sketch by hand a graph of the derivative
\[
    y = f^\prime(\theta) = ds/d\theta .
\]
Be sure to include variable names, units, and scales on your axes. Explain your reasoning.

(c) Using only the animation (stop the motion), approximate the value of the derivative
\[
     \frac{ds}{d\theta} \Big|_{\theta = 3\pi/2} .
\]
Include units. Explain your reasoning.

(d) Use trigonometry to find an expression for the function $s=f(\theta)$.

(e) Find an expression for the derivative $ds/d\theta$. Show \emph{every step} in using the chain rule as in Examples 1 and 2. %and interpret its meaning. Graph the derivative and reconcile the graph with the physical situation.

(f) Use your result from part (f) and a calculator (or desmos) to approximate the value of the derivative
\[
     \frac{ds}{d\theta} \Big|_{\theta = 3\pi/2} 
\]
to the nearest thousandth.

(g) What are the units of the derivative in part (f)? Explain the meaning of the derivative, \emph{not} by giving a standard response about the rate of change of some quantity with respect to another, but by relating small changes.

(h) Use your response to part (f) to write an approximation for the change
\[
         \Delta s = f(\theta) - f(3\pi/2)
\]
in terms of the change 
\[
     \Delta \theta = \theta - 3\pi/2
\]
for values of $theta$ near $\theta=3\pi/2$. 


(i) Find a function 
\[
   s = g(t) \, , t\geq 0,
\]
that expresses your distance (in feet) to the flagpole in terms of the number of seconds since you started jogging. Assume you start at the point on the track nearest the flagpole.

(j) Find a function that expresses the rate of change (with respect to time) in your distance to the flagpole in terms of the number of seconds since you began jogging.

(k) Express the rate of change in part (b) in terms of your speed and the angle between the following two vectors:

\begin{itemize}
\item{the vector that gives your position relative to the flagpole}

\item{the vector that points in the direction of your motion}
\end{itemize}
\end{exercise}


\begin{exercise} \label{Ex:4rett4t4}
High tide of 10.83 feet at Edmonds at 12:28am, May 15, low tide at 6:58am of ?? feet, lowest tide of 1.64 feet at 5:32pm.

\begin{onlineOnly}
    \begin{center}
\desmos{zta9tkzzmx}{900}{600}
\end{center}
\end{onlineOnly}

Worksheet available at \href{https://www.desmos.com/calculator/zta9tkzzmx}{151: Edmonds Tides}
\end{exercise}

\begin{exercise}  \label{E:dfbgret333}
A pendulum of length $L$ feet is $L+5$ oscillates sinuosoidally between angles $-\theta_0$ and $\theta_0$ with period $2\pi\sqrt{L/g}$ seconds, where $g$ is a constant. The angles $\pm \theta_0$ are measured in radians from the downward vertical.

(a) Find a function 
\[
     h = f(\theta) \, , -\theta_0 \leq \theta \leq \theta_0 ,
\]
that expresses the height of the pendulum above its stagble equilibrium position (ie. its lowest point) in terms of the angle of rotation. Use the cosine function.

(b) Assume now that the pendulum is released from rest from the displacement angle $\theta = \theta_0$ at time $t=0$ seconds. Find a function
\[
       \theta = g(t) \, , t\geq 0 ,
\]
that expresses the displacement angle (in radians) in terms of the number of seconds since the pendulum was released. Use the cosine function.

(c) Find a function 
\[
      h = w(t)  \, , t\geq 0
\]
that expresses the height (in feet) of the pendulum above equilibrium in terms of the number of seconds since the pendulum was released.

(d) Find an expression for the derivative $dh/dt$ and interpret its meaning.




\end{exercise}


\end{document}
